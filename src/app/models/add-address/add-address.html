<div class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="bg-white rounded-lg shadow-lg w-full max-w-2xl p-6 relative">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">Add / Edit Address</h3>
        <form #addressForm="ngForm" (ngSubmit)="saveAddress(addressForm)">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Email</label>
                    <div class="flex items-center border rounded-lg bg-gray-100">
                        <span class="px-3 text-gray-500"><i class="fas fa-envelope"></i></span>
                        <input type="email" readonly [(ngModel)]="address.email" name="email"
                            class="w-full bg-gray-100 py-2 px-2 text-gray-700 focus:outline-none rounded-r-lg" />
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Country</label>
                    <div class="relative">
                        <select [(ngModel)]="address.country" name="country" required
                            class="block w-full appearance-none bg-white border border-gray-300 rounded-lg py-2 px-4 pr-10 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out cursor-pointer">
                            <option value="">Select Country</option>
                            <option *ngFor="let country of countries" [value]="country.name">{{ country.name}}</option>
                        </select>
                        <div
                            class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-400">
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                    <div *ngIf="addressForm.submitted && !address.country" class="text-red-500 text-xs mt-1">
                        Country is required
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">City</label>
                    <div class="flex items-center border rounded-lg bg-gray-100">
                        <span class="px-3 text-gray-500"><i class="fas fa-city"></i></span>
                        <input type="text" [(ngModel)]="address.city" name="city" required placeholder="Enter City"
                            class="w-full bg-gray-100 py-2 px-2 text-gray-700 focus:outline-none rounded-r-lg" />
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">State</label>
                    <div class="flex items-center border rounded-lg bg-gray-100">
                        <span class="px-3 text-gray-500"><i class="fas fa-map"></i></span>
                        <input type="text" [(ngModel)]="address.state" name="state" required placeholder="Enter State"
                            class="w-full bg-gray-100 py-2 px-2 text-gray-700 focus:outline-none rounded-r-lg" />
                    </div>
                </div>

                <div class="">
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Address Line 1</label>
                    <div class="flex items-center border rounded-lg bg-gray-100">
                        <span class="px-3 text-gray-500"><i class="fa-solid fa-address-card"></i></span>
                        <input type="text" name="address_1" [(ngModel)]="address.address_1" required
                            placeholder="Enter Address 1"
                            class="w-full bg-gray-100 py-2 px-2 text-gray-700 focus:outline-none rounded-r-lg"
                            required />
                    </div>
                </div>

                <div class="">
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Address Line 2</label>
                    <div class="flex items-center border rounded-lg bg-gray-100">
                        <span class="px-3 text-gray-500"><i class="fa-solid fa-location-dot"></i></span>
                        <input type="text" name="address_2" [(ngModel)]="address.address_2" required
                            placeholder="Enter Address 2"
                            class="w-full bg-gray-100 py-2 px-2 text-gray-700 focus:outline-none rounded-r-lg" />
                    </div>

                </div>

                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Postal Code</label>
                    <div class="flex items-center border rounded-lg bg-gray-100">
                        <span class="px-3 text-gray-500"><i class="fas fa-mail-bulk"></i></span>
                        <input type="text" [(ngModel)]="address.postalCode" name="postalCode"
                            placeholder="Enter Postal Code"
                            class="w-full bg-gray-100 py-2 px-2 text-gray-700 focus:outline-none rounded-r-lg" />
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Contact Person</label>
                    <div class="flex items-center border rounded-lg bg-gray-100">
                        <span class="px-3 text-gray-500"><i class="fas fa-user-tie"></i></span>
                        <input type="text" [(ngModel)]="address.contactPerson" name="contactPerson"
                            placeholder="Enter Contact Person"
                            class="w-full bg-gray-100 py-2 px-2 text-gray-700 focus:outline-none rounded-r-lg" />
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Contact Number</label>
                    <div class="flex items-center border rounded-lg bg-gray-100">
                        <span class="px-3 text-gray-500"><i class="fas fa-phone-alt"></i></span>
                        <input type="text" [(ngModel)]="address.contactNumber" name="contactNumber" required
                            placeholder="Contact Number"
                            class="w-full bg-gray-100 py-2 px-2 text-gray-700 focus:outline-none rounded-r-lg" />
                    </div>
                    <div *ngIf="addressForm.submitted && isContactNumberInvalid()" class="text-red-500 text-xs mt-1">
                        Enter a valid 10-digit number
                    </div>
                </div>
            </div>
            <div class="mt-6 flex justify-end space-x-3">
                <button type="button" (click)="closeModal()"
                    class="px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100">
                    Cancel
                </button>
                <button type="submit"
                    class="py-2 px-3 rounded-lg cursor-pointer bg-gradient-to-r from-indigo-600 to-indigo-400 text-white font-semibold hover:scale-105 transition transform shadow-md flex justify-center items-center space-x-2">
                    <span *ngIf="!isSavingAddress">Save</span>
                    <span *ngIf="isSavingAddress" class="flex items-center space-x-2">
                        <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none"
                            viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                            </circle>
                            <path class="opacity-75" fill="currentColor"
                                d="M4 12a8 8 0 018-8v4l3.5-3.5L12 0v4a8 8 0 100 16v-4l-3.5 3.5L12 24v-4a8 8 0 01-8-8z">
                            </path>
                        </svg>
                        <span>Saving...</span>
                    </span>
                </button>
            </div>
            <button type="button" (click)="closeModal()"
                class="absolute top-3 right-3 text-gray-500 hover:text-gray-700">
                <i class="fas fa-times text-lg"></i>
            </button>
        </form>
    </div>
</div>
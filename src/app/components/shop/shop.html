<app-header></app-header>
<section id="popular-products" class="py-28 bg-gray-50">
    <div
        class="container transform transition-all duration-300 hover:scale-[1.01] animate-fade-in max-w-7xl mx-auto px-4">

        <div class="mb-10 border-b pb-6">
            <h1 class="text-3xl md:text-4xl font-extrabold text-gray-800 tracking-tight">
                Popular Products
            </h1>
            <p class="text-gray-500 mt-2">
                Discover experienced doctors in your specialty and book appointments easily.
            </p>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
            <ng-container *ngIf="loading; else productList">
                <div *ngFor="let sk of [1,2,3,4,5,6]"
                    class="bg-white shadow-lg rounded-xl overflow-hidden flex flex-col">
                    <div class="h-56 skeleton"></div>
                    <div class="p-5 flex flex-col flex-grow space-y-3">
                        <div class="h-4 w-3/4 rounded skeleton"></div>
                        <div class="h-3 w-1/2 rounded skeleton"></div>
                        <div class="h-3 w-full rounded skeleton"></div>
                        <div class="h-5 w-1/3 rounded skeleton"></div>
                        <div class="flex gap-3 mt-auto">
                            <div class="h-8 w-20 rounded skeleton"></div>
                            <div class="h-8 w-20 rounded skeleton"></div>
                        </div>
                    </div>
                </div>
            </ng-container>

            <ng-template #productList>
                <div *ngFor="let product of products"
                    class="bg-white shadow-lg rounded-xl overflow-hidden flex flex-col">
                    <div class="relative flex items-center justify-center h-56 bg-gray-50">
                        <img *ngIf="product.im_ProductImages?.length"
                            [src]="'https://apioonsoft.keesaexpress.com/' + product.im_ProductImages[0].image_url"
                            alt="{{ product.brand }}"
                            class="w-40 h-40 transition transform hover:scale-105 duration-300 object-contain">
                        <div class="absolute top-4 right-4 text-white text-xs font-semibold px-3 py-1 rounded-full shadow"
                            [ngClass]="product.stock_quantity > 0 ? 'bg-green-500' : 'bg-red-500'">
                            {{ product.stock_quantity > 0 ? 'AVAILABLE' : 'OUT OF STOCK' }}
                        </div>
                    </div>

                    <div class="flex flex-col flex-grow p-5 text-center">
                        <h5 class="text-lg font-semibold mb-1 text-gray-800">{{ product.title }}</h5>
                        <p class="text-teal-600 mb-1">{{ product.brand }}</p>
                        <p class="text-gray-500 mb-3 text-sm line-clamp-2">{{ product.description }}</p>
                        <p class="text-lg font-bold text-green-600 mb-4">${{ product.price }}</p>

                        <div class="mt-auto flex justify-center gap-3">
                            <a (click)="onProductDetails(product)"
                                class="border border-teal-600 cursor-pointer text-teal-600 text-sm px-4 py-2 rounded-lg hover:bg-teal-50 transition">
                                View Details
                            </a>
                            <a (click)="onBook(product)"
                                class="bg-teal-600 text-white cursor-pointer text-sm px-4 py-2 rounded-lg hover:bg-teal-700 transition">
                                Add to Cart
                            </a>
                        </div>
                    </div>
                </div>
            </ng-template>
        </div>
    </div>
</section>
<app-footer></app-footer>